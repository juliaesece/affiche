<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AdC affiche</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="http://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="script.js"></script>
</head>
<body>

<!-- AFFICHE -->

  <div id="affiche-wrapper">
    <img id="img-background"  src="./agenda-WE.png">
    <div id="jours-wrapper">
      <div id="jour1" class="jour">
          <h1 id="samedi">Samedi</h1>
          <div id="evenementsDeSam">

              <!-- TEST -->

              <!-- <div id="evenement1" class="evenement">
              <h2 id="titre1" class="titre-d-evenement"> Titre </h2>
              <p class="horaire"> <img  src="./clock.png" class="iconito"> <span id="horaire1"> Horaire </span></p>
              <p class="salle"><img  src="./location.png" class="iconito"> <span id="salle1"> Salle </span></p>
              <p class="description">12h : rencontre à la Buvette (RdC), 14h : ateliers, studio photo, et plus, 16h30 : cours de danse collective, 17h : départ du défilé (depuis la place Baudoyer) direction les Amarres, où il y aura un défilé, un concert, et des surprises !</p>
              </div>
               -->
            </div>
        </div>


      <div id="jour2" class="jour">
          <h1 id="dimanche">Dimanche</h1>
          <div id="evenementsDeDim">
          </div>
      </div>

      <div id="jour3" class="jour">
          <h1 id="toutLeWE">Tout le Week-end</h1>
          <div id="evenementsDeWE">
          </div>
      </div>
      </div>
    </div>

<!-- FORMULAIRE -->

<!-- JOURS et NB d'EVENTS PAR JOUR -->

<div id="forms-wrapper">

  <form id="events-form">
    <h1 class="form accrossHorizontal"> Jours </h1>
    <div class="form-check accrossHorizontal">
      <input class="form-check-input" type="checkbox" id="if-samedi" name="if-samedi">
      <label class="form-check-label" for="if-samedi">Samedi</label>
    </div>
    <div class="form-floating samediChecks">
      <input class="numberInput samediChecks form-control" type="number" id="fNbEventsSamedi" name="fNbEventsSamedi" placeholder="Samedi"><br class="samediChecks">
      <label class="samediChecks" for="fNbEvents">Nombre d'événements</label>
    </div>
    <div class="form-floating samediChecks">
      <input class="numberInput samediChecks form-control" type="number" id="fNbEventsSamediDes" name="fNbEventsSamediDes" placeholder="Combien ont besoin d'une description"><br class="samediChecks"><br>
      <label class="samediChecks" for="fNbEventsDes">Combien ont besoin d'une description</label>
    </div>

    <div class="form-check accrossHorizontal">
      <input class="form-check-input" type="checkbox" id="if-dimanche" name="if-dimanche">
      <label class="form-check-label" for="if-dimanche">Dimanche</label>
    </div>
    <div class="form-floating dimChecks">
      <input class="numberInput dimChecks form-control" type="number" id="fNbEventsDimanche" name="fNbEventsDimanche" placeholder="Nombre d'événements"><br class="dimChecks">
      <label class="dimChecks" for="fNbEvents">Nombre d'événements</label>
    </div>
    <div class="form-floating dimChecks">
      <input class="numberInput dimChecks form-control" type="number" id="fNbEventsDimancheDes" name="fNbEventsDimancheDes"  placeholder="Combien ont besoin d'une description"><br class="dimChecks"><br>
      <label class="dimChecks" for="fNbEventsDes">Combien ont besoin d'une description</label>
    </div>

    <div class="form-check accrossHorizontal">
      <input class="form-check-input" type="checkbox" id="if-WE" name="if-WE">
      <label class="form-check-label" for="if-WE">Tout le week-end</label>
    </div>
    <div class="form-floating WEChecks">
      <input class="numberInput WEChecks form-control" type="number" id="fNbEventsWE" name="fNbEventsWE" placeholder="Nombre d'événéments"><br class="WEChecks">
      <label class="WEChecks" for="fNbEventsWE">Nombre d'événements</label>
    </div>
    <div class="form-floating WEChecks">
      <input class="numberInput WEChecks form-control" type="number" id="fNbEventsWEDes" name="fNbEventsWEDes" placeholder="Combien ont besoin d'une inscription"><br class="WEChecks"><br>
      <label class="WEChecks" for="fNbEventsWEDes">Combien ont besoin d'une description</label>
    </div>

    <button class="btn btn-light" type="button" id="btnNbEvents"> Submit </button>
    <button class="btn btn-light" type="button" id="layout"> Layout </button><br><br>

  </form>
  <br>

<!-- Detail des evenements -->
<form id="detail-form">
    <div id="detail-events">
      <h3 id="ftitle-samedi" class="accrossHorizontal"> Evenements du samedi </h3>
      <!-- pour tests
      <label for="fnom1">Nom de l'event:</label><br>
      <input type="text" id="fnom1" name="fnom1"><br>
      <label for="fhoraire1">Horaire:</label><br>
      <input type="text" id="fhoraire1" name="fhoraire1"><br>
      <label for="fsalle1">Salle:</label><br>
      <input type="text" id="fsalle1" name="fsalle1"><br><br>
      <button type="button" id="btn0"> Submit </button> -->
      <h3 id="ftitle-dimanche" class="accrossHorizontal"> Evenements du dimanche </h3>
      <h3 id="ftitle-WE" class="accrossHorizontal"> Evenements du WE </h3>
    </div>
</form>

<button id="downloadAffiche" class="btn btn-light">Download</button>

<button id="downloadAffiche2" class="btn btn-light">Download</button>

</div>

<script>

// add to affiche from new/added forms
  function addToAffiche(nb, jour, des) {
    var temporaryId = String(nb);

    if (jour == 1) {
      var post = "#evenementsDeSam";
    } else if (jour == 2 ) {
      var post = "#evenementsDeDim";
    } else {
      var post = "#evenementsDeWE";
    }
     var titre = $("#fnom"+ temporaryId).val();
     var horaire = $("#fhoraire" + temporaryId).val();
     var salle = $("#fsalle" + temporaryId).val();

     console.log("des is " + typeof(des))

     if (!des) {
       var toInsert = "<div id='evenement" + temporaryId + "' class='noDes evenement'>\
            <h2 id='titre" + temporaryId + "' class='titre-d-evenement'> " + titre + " </h2>\
            <p class='horaire'><img src='./clock.png'  class='iconito'> <span id='horaire" + temporaryId + "'> " + horaire + " </span></p>\
            <p class='salle'><img src='./location.png'  class='iconito'> <span id='salle" + temporaryId + "'> " + salle + " </span></p>\
          </div>";
     } else {
       var description = $("#fDes" + temporaryId).val();
       var toInsert = "<div id='evenement" + temporaryId + "' class='des evenement maxThreeEvents evnmtMargin accrossHorizontal'>\
            <h2 id='titre" + temporaryId + "' class='titre-d-evenement cardGauche'> " + titre + " </h2>\
            <p class='horaire cardGauche'><img src='./clock.png'  class='iconito'> <span id='horaire" + temporaryId + "'> " + horaire + " </span></p>\
            <p class='salle cardGauche'><img src='./location.png' class='iconito'> <span id='salle" + temporaryId + "'> " + salle + " </span></p>\
            <p class='description cardDroite onlyOneRow'>" + description + "</p>\
          </div>";
     }

      $(post).append(toInsert);

  };

  // $("#").click(function(){
  //   const affiche = $("#").html();
  //   html2pdf().set({filename: 'affiche.pdf'}).from(affiche).save();
  // });

  window.onload = function () {

    document.getElementById("downloadAffiche")
        .addEventListener("click", () => {
            // const affiche = this.document.getElementById("affiche-wrapper");
            var affiche = "";

            var download = function(){
              // var link = document.createElement('a');
              // link.download = 'filename.png';
              // link.href = document.getElementById('dCanvas').toDataURL()
              // link.click();
              var canvas = document.getElementById('dCanvas');
              console.log(canvas);
              var anchor = document.createElement("a");
              anchor.href = canvas.toDataURL("image/png");
              nchor.download = "IMAGE.PNG";
              anchor.click();
            }

            html2canvas(document.querySelector("#affiche-wrapper")).then(canvas => {
                canvas.setAttribute("id", "dCanvas")
                document.body.appendChild(canvas)
                affiche = canvas;
            });

            console.log(affiche);



          });

          document.getElementById("downloadAffiche2")
              .addEventListener("click", () => {
                  // const affiche = this.document.getElementById("affiche-wrapper");

                  var download = function(){
                    // var link = document.createElement('a');
                    // link.download = 'filename.png';
                    // link.href = document.getElementById('dCanvas').toDataURL()
                    // link.click();
                    var canvas = document.getElementById('dCanvas');
                    console.log(canvas);
                    var anchor = document.createElement("a");
                    anchor.href = canvas.toDataURL("image/png");
                    nchor.download = "IMAGE.PNG";
                    anchor.click();
                  }

                  download();

                  console.log(affiche);



                });

}

</script>
</body>
</html>
